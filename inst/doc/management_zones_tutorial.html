<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Management zones tutorial</title>


<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Management zones tutorial</h1>


<div id="TOC">
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#usage">Usage</a><ul>
<li><a href="#simple-minimum-set-problem">Simple minimum set problem</a></li>
<li><a href="#adding-management-zones">Adding management zones</a></li>
<li><a href="#multiple-zones-with-varying-costs">Multiple zones with varying costs</a></li>
<li><a href="#multiple-zones-with-complex-targets">Multiple zones with complex targets</a></li>
<li><a href="#multiple-zones-with-extra-constraints">Multiple zones with extra constraints</a></li>
<li><a href="#multiple-zones-with-fragmentation-penalties">Multiple zones with fragmentation penalties</a></li>
<li><a href="#multiple-zones-with-fragmentation-penalties-and-mandatory-allocations">Multiple zones with fragmentation penalties and mandatory allocations</a></li>
</ul></li>
<li><a href="#conclusion">Conclusion</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>One of the main aims in conservation planning is to identify the most cost-effective set of areas to manage biodiversity <span class="citation">(Margules &amp; Pressey 2000)</span>. To achieve this, prioritizations are generally created to identify areas for expanding protected area systems. However, many real-world conservation problems do not simply involve deciding if an area should be protected or not <span class="citation">(e.g., Klein <em>et al.</em> 2009; Stigner <em>et al.</em> 2016)</span>. Instead, many problems involve a range of different management categories and the goal is to determine which areas should be allocated to which management category. For example, a manager might have a range of different methods (e.g., baiting or trapping at various intensities) for controlling invasive pests in a set of different areas <span class="citation">(e.g., Cattarino <em>et al.</em> 2018)</span>. They would need a prioritization that shows which control methods should be implemented in which areas. In this particular case, a binary prioritization showing which areas contain the most biodiversity is simply not helpful. Furthermore, many real-world problems require decisions that meet multiple, and sometimes conflicting, objectives from different stakeholders. For example, a manager might need to implement a set of no-take and partial-take areas to prevent overfishing, but also ensure that there still remain plenty of areas for fishing activities <span class="citation">(e.g., Wilson <em>et al.</em> 2010; Klein <em>et al.</em> 2013)</span>. Popularized by the <em>Marxan with Zones</em> decision support tool <span class="citation">(Watts <em>et al.</em> 2009)</span>, this concept has become known as “zones” and is becoming increasingly important in conservation planning.</p>
<p>The aim of this tutorial is to showcase the zones functionality of the <em>prioritizr R</em> package. It will assume a certain level of familiarity with conservation planning terminology and the package. If you don’t have much experience in either of these topics, we recommend first reading the <a href="package_overview.html"><em>Package overview</em></a> vignette.</p>
</div>
<div id="usage" class="section level2">
<h2>Usage</h2>
<div id="simple-minimum-set-problem" class="section level3">
<h3>Simple minimum set problem</h3>
<p>In the <em>prioritizr R</em> package, all conservation planning problems – including those which contain multiple management zones or actions – are initialized using the <code>problem</code> function. To refresh our memory on how we can construct problems, let us quickly construct a simple conservation planning problem. This problem will use the simulated built-in planning unit and feature data distributed with the package. It will have a minimum set objective, targets which require that solutions secure to 10% of the habitat in the study area for each feature, and binary decision variables indicating that planning units are selected or not selected for protection.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co"># load packages</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">library</span>(prioritizr)</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">library</span>(terra)</a>
<a class="sourceLine" id="cb1-4" title="4"><span class="kw">library</span>(tibble)</a>
<a class="sourceLine" id="cb1-5" title="5"></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="co"># set seed for reproducibility</span></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="kw">set.seed</span>(<span class="dv">500</span>)</a></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="co"># load data</span></a>
<a class="sourceLine" id="cb2-2" title="2">sim_pu_raster &lt;-<span class="st"> </span><span class="kw">get_sim_pu_raster</span>()</a>
<a class="sourceLine" id="cb2-3" title="3">sim_features &lt;-<span class="st"> </span><span class="kw">get_sim_features</span>()</a>
<a class="sourceLine" id="cb2-4" title="4"></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="co"># create targets for each of the five features</span></a>
<a class="sourceLine" id="cb2-6" title="6">t1 &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="fl">0.1</span>, <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb2-7" title="7"></a>
<a class="sourceLine" id="cb2-8" title="8"><span class="co"># build single-zone problem</span></a>
<a class="sourceLine" id="cb2-9" title="9">p1 &lt;-</a>
<a class="sourceLine" id="cb2-10" title="10"><span class="st">  </span><span class="kw">problem</span>(sim_pu_raster, sim_features) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="st">  </span><span class="kw">add_min_set_objective</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-12" title="12"><span class="st">  </span><span class="kw">add_relative_targets</span>(t1) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-13" title="13"><span class="st">  </span><span class="kw">add_binary_decisions</span>()</a>
<a class="sourceLine" id="cb2-14" title="14"></a>
<a class="sourceLine" id="cb2-15" title="15"><span class="co"># print problem</span></a>
<a class="sourceLine" id="cb2-16" title="16"><span class="kw">print</span>(p1)</a></code></pre></div>
<pre><code>## A conservation problem (&lt;ConservationProblem&gt;)
## ├•data
## │├•features:    &quot;feature_1&quot;, &quot;feature_2&quot;, &quot;feature_3&quot;, &quot;feature_4&quot;, and &quot;feature_5&quot; (5 total)
## │└•planning units:
## │ ├•data:       &lt;SpatRaster&gt; (90 total)
## │ ├•costs:      continuous values (between 190.1328 and 215.8638)
## │ ├•extent:     0, 0, 1, 1 (xmin, ymin, xmax, ymax)
## │ └•CRS:        Undefined Cartesian SRS (projected)
## ├•formulation
## │├•objective:   minimum set objective
## │├•penalties:   none specified
## │├•targets:     relative targets (between 0.1 and 0.1)
## │├•constraints: none specified
## │└•decisions:   binary decision
## └•optimization
##  ├•portfolio:   default portfolio
##  └•solver:      gurobi solver (`gap` = 0.1, `time_limit` = 2147483647, `first_feasible` = FALSE, …)
## # ℹ Use `summary(...)` to see complete formulation.</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="co"># solve problem</span></a>
<a class="sourceLine" id="cb4-2" title="2">s1 &lt;-<span class="st"> </span><span class="kw">solve</span>(p1)</a></code></pre></div>
<pre><code>## Set parameter Username
## Set parameter TimeLimit to value 2147483647
## Set parameter MIPGap to value 0.1
## Set parameter Presolve to value 2
## Set parameter Threads to value 1
## Academic license - for non-commercial use only - expires 2025-06-05
## Gurobi Optimizer version 11.0.0 build v11.0.0rc2 (linux64 - &quot;Ubuntu 20.04.6 LTS&quot;)
## 
## CPU model: AMD Ryzen Threadripper 3960X 24-Core Processor, instruction set [SSE2|AVX|AVX2]
## Thread count: 24 physical cores, 48 logical processors, using up to 1 threads
## 
## Optimize a model with 5 rows, 90 columns and 450 nonzeros
## Model fingerprint: 0x4bb5d283
## Variable types: 0 continuous, 90 integer (90 binary)
## Coefficient statistics:
##   Matrix range     [2e-01, 9e-01]
##   Objective range  [2e+02, 2e+02]
##   Bounds range     [1e+00, 1e+00]
##   RHS range        [3e+00, 8e+00]
## Found heuristic solution: objective 2337.9617767
## Presolve time: 0.00s
## Presolved: 5 rows, 90 columns, 450 nonzeros
## Variable types: 0 continuous, 90 integer (90 binary)
## Found heuristic solution: objective 2332.1004028
## Root relaxation presolved: 5 rows, 90 columns, 450 nonzeros
## 
## 
## Root relaxation: objective 1.931582e+03, 12 iterations, 0.00 seconds (0.00 work units)
## 
##     Nodes    |    Current Node    |     Objective Bounds      |     Work
##  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
## 
##      0     0 1931.58191    0    4 2332.10040 1931.58191  17.2%     -    0s
## H    0     0                    1987.3985291 1931.58191  2.81%     -    0s
## 
## Explored 1 nodes (12 simplex iterations) in 0.00 seconds (0.00 work units)
## Thread count was 1 (of 48 available processors)
## 
## Solution count 3: 1987.4 2332.1 2337.96 
## 
## Optimal solution found (tolerance 1.00e-01)
## Best objective 1.987398529053e+03, best bound 1.931581907658e+03, gap 2.8085%</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="co"># calculate feature representation</span></a>
<a class="sourceLine" id="cb6-2" title="2">r1 &lt;-<span class="st"> </span><span class="kw">eval_feature_representation_summary</span>(p1, s1)</a>
<a class="sourceLine" id="cb6-3" title="3"><span class="kw">print</span>(r1)</a></code></pre></div>
<pre><code>## # A tibble: 5 × 5
##   summary feature   total_amount absolute_held relative_held
##   &lt;chr&gt;   &lt;chr&gt;            &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;
## 1 overall feature_1         83.3          8.91         0.107
## 2 overall feature_2         31.2          3.13         0.100
## 3 overall feature_3         72.0          7.34         0.102
## 4 overall feature_4         42.7          4.35         0.102
## 5 overall feature_5         56.7          6.01         0.106</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="co"># plot solution</span></a>
<a class="sourceLine" id="cb8-2" title="2"><span class="kw">plot</span>(</a>
<a class="sourceLine" id="cb8-3" title="3">  s1, <span class="dt">main =</span> <span class="st">&quot;solution&quot;</span>,</a>
<a class="sourceLine" id="cb8-4" title="4">  <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.1</span>, <span class="fl">1.1</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.1</span>, <span class="fl">1.1</span>), <span class="dt">axes =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb8-5" title="5">)</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="adding-management-zones" class="section level3">
<h3>Adding management zones</h3>
<p>Now let us imagine that instead of having a single management zone (e.g., protected area), we have two management zones. Similar to the example above, we require a solution that secures 10 % of the habitat in the study area for each feature in the first management zone. But we also require a solution that secures 5 % of the habitat in the study area for each feature in the second management zone. Each planning unit must be allocated to either zone or not selected for management at all. In this example, each planning unit costs the same when it is allocated to either of the two zones. We can formulate and solve this problem using the following code.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="co"># create a matrix with the targets</span></a>
<a class="sourceLine" id="cb9-2" title="2"><span class="co"># here each column corresponds to a different zone,</span></a>
<a class="sourceLine" id="cb9-3" title="3"><span class="co"># each row corresponds to a different feature, and</span></a>
<a class="sourceLine" id="cb9-4" title="4"><span class="co"># each cell value corresponds to the target</span></a>
<a class="sourceLine" id="cb9-5" title="5">t2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">nrow =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb9-6" title="6">t2[, <span class="dv">1</span>] &lt;-<span class="st"> </span><span class="fl">0.1</span></a>
<a class="sourceLine" id="cb9-7" title="7">t2[, <span class="dv">2</span>] &lt;-<span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb9-8" title="8"></a>
<a class="sourceLine" id="cb9-9" title="9"><span class="co"># print targets</span></a>
<a class="sourceLine" id="cb9-10" title="10"><span class="kw">print</span>(t2)</a></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]  0.1 0.05
## [2,]  0.1 0.05
## [3,]  0.1 0.05
## [4,]  0.1 0.05
## [5,]  0.1 0.05</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="co"># create a zones object that contains the amount of each feature</span></a>
<a class="sourceLine" id="cb11-2" title="2"><span class="co"># in each planning unit when it is allocated to each zone</span></a>
<a class="sourceLine" id="cb11-3" title="3"><span class="co"># since our zones pertain to the same habitat data, we will</span></a>
<a class="sourceLine" id="cb11-4" title="4"><span class="co"># specify the same habitat data for each zone</span></a>
<a class="sourceLine" id="cb11-5" title="5">z2 &lt;-<span class="st"> </span><span class="kw">zones</span>(<span class="st">&quot;zone 1&quot;</span> =<span class="st"> </span>sim_features, <span class="st">&quot;zone 2&quot;</span> =<span class="st"> </span>sim_features)</a>
<a class="sourceLine" id="cb11-6" title="6"></a>
<a class="sourceLine" id="cb11-7" title="7"><span class="co"># print zones</span></a>
<a class="sourceLine" id="cb11-8" title="8"><span class="kw">print</span>(z2)</a></code></pre></div>
<pre><code>## A zones object &lt;ZonesSpatRaster/Zones&gt;
## • zones:    &quot;zone 1&quot; and &quot;zone 2&quot; (2 total)
## • features: &quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, and &quot;5&quot; (5 total)</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="co"># create a multi-layer raster with the planning unit data</span></a>
<a class="sourceLine" id="cb13-2" title="2"><span class="co">## since our planning unit costs are the same for each zone,</span></a>
<a class="sourceLine" id="cb13-3" title="3"><span class="co">## we will create a raster with two replicates of the cost data</span></a>
<a class="sourceLine" id="cb13-4" title="4">pu2 &lt;-<span class="st"> </span><span class="kw">c</span>(sim_pu_raster, sim_pu_raster)</a>
<a class="sourceLine" id="cb13-5" title="5"></a>
<a class="sourceLine" id="cb13-6" title="6"><span class="co"># print planning units</span></a>
<a class="sourceLine" id="cb13-7" title="7"><span class="kw">print</span>(pu2)</a></code></pre></div>
<pre><code>## class       : SpatRaster 
## dimensions  : 10, 10, 2  (nrow, ncol, nlyr)
## resolution  : 0.1, 0.1  (x, y)
## extent      : 0, 1, 0, 1  (xmin, xmax, ymin, ymax)
## coord. ref. : Undefined Cartesian SRS 
## sources     : sim_pu_raster.tif  
##               sim_pu_raster.tif  
## names       :    layer,    layer 
## min values  : 190.1328, 190.1328 
## max values  : 215.8638, 215.8638</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="co"># build two-zone problem</span></a>
<a class="sourceLine" id="cb15-2" title="2">p2 &lt;-</a>
<a class="sourceLine" id="cb15-3" title="3"><span class="st">  </span><span class="kw">problem</span>(pu2, z2) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb15-4" title="4"><span class="st">  </span><span class="kw">add_min_set_objective</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb15-5" title="5"><span class="st">  </span><span class="kw">add_relative_targets</span>(t2) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb15-6" title="6"><span class="st">  </span><span class="kw">add_binary_decisions</span>()</a>
<a class="sourceLine" id="cb15-7" title="7"></a>
<a class="sourceLine" id="cb15-8" title="8"><span class="co"># print problem</span></a>
<a class="sourceLine" id="cb15-9" title="9"><span class="kw">print</span>(p2)</a></code></pre></div>
<pre><code>## A conservation problem (&lt;ConservationProblem&gt;)
## ├•data
## │├•zones:       &quot;zone 1&quot; and &quot;zone 2&quot; (2 total)
## │├•features:    &quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, and &quot;5&quot; (5 total)
## │└•planning units:
## │ ├•data:       &lt;SpatRaster&gt; (90 total)
## │ ├•costs:      continuous values (between 190.1328 and 215.8638)
## │ ├•extent:     0, 0, 1, 1 (xmin, ymin, xmax, ymax)
## │ └•CRS:        Undefined Cartesian SRS (projected)
## ├•formulation
## │├•objective:   minimum set objective
## │├•penalties:   none specified
## │├•targets:     relative targets (between 0.05 and 0.1)
## │├•constraints: none specified
## │└•decisions:   binary decision
## └•optimization
##  ├•portfolio:   default portfolio
##  └•solver:      gurobi solver (`gap` = 0.1, `time_limit` = 2147483647, `first_feasible` = FALSE, …)
## # ℹ Use `summary(...)` to see complete formulation.</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="co"># solve problem</span></a>
<a class="sourceLine" id="cb17-2" title="2">s2 &lt;-<span class="st"> </span><span class="kw">solve</span>(p2)</a></code></pre></div>
<pre><code>## Set parameter Username
## Set parameter TimeLimit to value 2147483647
## Set parameter MIPGap to value 0.1
## Set parameter Presolve to value 2
## Set parameter Threads to value 1
## Academic license - for non-commercial use only - expires 2025-06-05
## Gurobi Optimizer version 11.0.0 build v11.0.0rc2 (linux64 - &quot;Ubuntu 20.04.6 LTS&quot;)
## 
## CPU model: AMD Ryzen Threadripper 3960X 24-Core Processor, instruction set [SSE2|AVX|AVX2]
## Thread count: 24 physical cores, 48 logical processors, using up to 1 threads
## 
## Optimize a model with 100 rows, 180 columns and 1080 nonzeros
## Model fingerprint: 0x5c140ae3
## Variable types: 0 continuous, 180 integer (180 binary)
## Coefficient statistics:
##   Matrix range     [2e-01, 1e+00]
##   Objective range  [2e+02, 2e+02]
##   Bounds range     [1e+00, 1e+00]
##   RHS range        [1e+00, 8e+00]
## Found heuristic solution: objective 3568.4931335
## Presolve time: 0.00s
## Presolved: 100 rows, 180 columns, 1080 nonzeros
## Variable types: 0 continuous, 180 integer (180 binary)
## Found heuristic solution: objective 3440.6550903
## Root relaxation presolved: 100 rows, 180 columns, 1080 nonzeros
## 
## 
## Root relaxation: objective 2.911333e+03, 75 iterations, 0.00 seconds (0.00 work units)
## 
##     Nodes    |    Current Node    |     Objective Bounds      |     Work
##  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
## 
##      0     0 2911.33336    0   10 3440.65509 2911.33336  15.4%     -    0s
## H    0     0                    2996.1175232 2911.33336  2.83%     -    0s
## 
## Explored 1 nodes (79 simplex iterations) in 0.00 seconds (0.00 work units)
## Thread count was 1 (of 48 available processors)
## 
## Solution count 3: 2996.12 3440.66 3568.49 
## 
## Optimal solution found (tolerance 1.00e-01)
## Best objective 2.996117523193e+03, best bound 2.911333356299e+03, gap 2.8298%</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="co"># calculate feature representation</span></a>
<a class="sourceLine" id="cb19-2" title="2">r2 &lt;-<span class="st"> </span><span class="kw">eval_feature_representation_summary</span>(p2, s2)</a>
<a class="sourceLine" id="cb19-3" title="3"><span class="kw">print</span>(r2)</a></code></pre></div>
<pre><code>## # A tibble: 15 × 5
##    summary feature total_amount absolute_held relative_held
##    &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;
##  1 overall 1              167.          13.4         0.0803
##  2 overall 2               62.4          4.77        0.0765
##  3 overall 3              144.          10.9         0.0758
##  4 overall 4               85.3          6.41        0.0751
##  5 overall 5              113.           9.06        0.0799
##  6 zone 1  1               83.3          8.87        0.106 
##  7 zone 1  2               31.2          3.21        0.103 
##  8 zone 1  3               72.0          7.21        0.100 
##  9 zone 1  4               42.7          4.27        0.100 
## 10 zone 1  5               56.7          6.03        0.106 
## 11 zone 2  1               83.3          4.50        0.0541
## 12 zone 2  2               31.2          1.56        0.0500
## 13 zone 2  3               72.0          3.70        0.0515
## 14 zone 2  4               42.7          2.14        0.0501
## 15 zone 2  5               56.7          3.03        0.0533</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="co"># plot solution</span></a>
<a class="sourceLine" id="cb21-2" title="2"><span class="co"># here we use the category layer function to generate raster showing the zone</span></a>
<a class="sourceLine" id="cb21-3" title="3"><span class="co"># that each planning unit was allocated. Specifically, pixels with the</span></a>
<a class="sourceLine" id="cb21-4" title="4"><span class="co"># value 1 (yellow) are allocated to &quot;zone 1&quot; and pixels with the value 2 (green)</span></a>
<a class="sourceLine" id="cb21-5" title="5"><span class="co"># are allocated to &quot;zone 2&quot;. Units depicted in gray are not allocated</span></a>
<a class="sourceLine" id="cb21-6" title="6"><span class="co"># to any zone.</span></a>
<a class="sourceLine" id="cb21-7" title="7"><span class="kw">plot</span>(</a>
<a class="sourceLine" id="cb21-8" title="8">  <span class="kw">category_layer</span>(s2), <span class="dt">main =</span> <span class="st">&quot;solution&quot;</span>,</a>
<a class="sourceLine" id="cb21-9" title="9">  <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.1</span>, <span class="fl">1.1</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.1</span>, <span class="fl">1.1</span>), <span class="dt">axes =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb21-10" title="10">)</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="multiple-zones-with-varying-costs" class="section level3">
<h3>Multiple zones with varying costs</h3>
<p>Real-world problems often have different costs for managing planning units under different zones. These problems also tend to have different expected amounts of each feature when planning units are managed differently. So let us consider a slightly more complex example. Similar to before we will have two management zones. But this time, the cost of managing each planning unit is different depending on which management zone it is assigned to in the solution. Furthermore, when we assign a planning unit to the second zone, we only expect to end up with half of the habitat we would get if we managed the unit in the first zone (e.g., because the second zone is a partial-take zone and the first zone is a no-take zone). We will use the same target data as in the previous example.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"><span class="co"># create new planning unit and cost data</span></a>
<a class="sourceLine" id="cb22-2" title="2">pu3 &lt;-<span class="st"> </span><span class="kw">get_sim_zones_pu_raster</span>()[[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]]</a>
<a class="sourceLine" id="cb22-3" title="3"></a>
<a class="sourceLine" id="cb22-4" title="4"><span class="co"># plot cost data</span></a>
<a class="sourceLine" id="cb22-5" title="5"><span class="kw">plot</span>(</a>
<a class="sourceLine" id="cb22-6" title="6">  pu3, <span class="dt">main =</span> <span class="kw">c</span>(<span class="st">&quot;zone 1&quot;</span>, <span class="st">&quot;zone 2&quot;</span>),</a>
<a class="sourceLine" id="cb22-7" title="7">  <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.1</span>, <span class="fl">1.1</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.1</span>, <span class="fl">1.1</span>), <span class="dt">axes =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb22-8" title="8">)</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="co"># create problem</span></a>
<a class="sourceLine" id="cb23-2" title="2">p3 &lt;-</a>
<a class="sourceLine" id="cb23-3" title="3"><span class="st">  </span><span class="kw">problem</span>(pu3, <span class="kw">zones</span>(sim_features, sim_features <span class="op">*</span><span class="st"> </span><span class="fl">0.5</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb23-4" title="4"><span class="st">  </span><span class="kw">add_min_set_objective</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb23-5" title="5"><span class="st">  </span><span class="kw">add_relative_targets</span>(t2) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb23-6" title="6"><span class="st">  </span><span class="kw">add_binary_decisions</span>()</a>
<a class="sourceLine" id="cb23-7" title="7"></a>
<a class="sourceLine" id="cb23-8" title="8"><span class="co"># print problem</span></a>
<a class="sourceLine" id="cb23-9" title="9"><span class="kw">print</span>(p3)</a></code></pre></div>
<pre><code>## A conservation problem (&lt;ConservationProblem&gt;)
## ├•data
## │├•zones:       &quot;1&quot; and &quot;2&quot; (2 total)
## │├•features:    &quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, and &quot;5&quot; (5 total)
## │└•planning units:
## │ ├•data:       &lt;SpatRaster&gt; (90 total)
## │ ├•costs:      continuous values (between 182.6017 and 221.363)
## │ ├•extent:     0, 0, 1, 1 (xmin, ymin, xmax, ymax)
## │ └•CRS:        Undefined Cartesian SRS (projected)
## ├•formulation
## │├•objective:   minimum set objective
## │├•penalties:   none specified
## │├•targets:     relative targets (between 0.05 and 0.1)
## │├•constraints: none specified
## │└•decisions:   binary decision
## └•optimization
##  ├•portfolio:   default portfolio
##  └•solver:      gurobi solver (`gap` = 0.1, `time_limit` = 2147483647, `first_feasible` = FALSE, …)
## # ℹ Use `summary(...)` to see complete formulation.</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="co"># solve problem</span></a>
<a class="sourceLine" id="cb25-2" title="2">s3 &lt;-<span class="st"> </span><span class="kw">solve</span>(p3)</a></code></pre></div>
<pre><code>## Set parameter Username
## Set parameter TimeLimit to value 2147483647
## Set parameter MIPGap to value 0.1
## Set parameter Presolve to value 2
## Set parameter Threads to value 1
## Academic license - for non-commercial use only - expires 2025-06-05
## Gurobi Optimizer version 11.0.0 build v11.0.0rc2 (linux64 - &quot;Ubuntu 20.04.6 LTS&quot;)
## 
## CPU model: AMD Ryzen Threadripper 3960X 24-Core Processor, instruction set [SSE2|AVX|AVX2]
## Thread count: 24 physical cores, 48 logical processors, using up to 1 threads
## 
## Optimize a model with 100 rows, 180 columns and 1080 nonzeros
## Model fingerprint: 0xdfa75166
## Variable types: 0 continuous, 180 integer (180 binary)
## Coefficient statistics:
##   Matrix range     [1e-01, 1e+00]
##   Objective range  [2e+02, 2e+02]
##   Bounds range     [1e+00, 1e+00]
##   RHS range        [8e-01, 8e+00]
## Found heuristic solution: objective 3667.7708740
## Presolve time: 0.00s
## Presolved: 100 rows, 180 columns, 1080 nonzeros
## Variable types: 0 continuous, 180 integer (180 binary)
## Found heuristic solution: objective 3388.0249329
## Root relaxation presolved: 100 rows, 180 columns, 1080 nonzeros
## 
## 
## Root relaxation: objective 2.884872e+03, 38 iterations, 0.00 seconds (0.00 work units)
## 
##     Nodes    |    Current Node    |     Objective Bounds      |     Work
##  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
## 
##      0     0 2884.87201    0    8 3388.02493 2884.87201  14.9%     -    0s
## H    0     0                    2958.1201477 2884.87201  2.48%     -    0s
## 
## Explored 1 nodes (38 simplex iterations) in 0.00 seconds (0.00 work units)
## Thread count was 1 (of 48 available processors)
## 
## Solution count 3: 2958.12 3388.02 3667.77 
## 
## Optimal solution found (tolerance 1.00e-01)
## Best objective 2.958120147705e+03, best bound 2.884872007846e+03, gap 2.4762%</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="co"># calculate feature representation</span></a>
<a class="sourceLine" id="cb27-2" title="2">r3 &lt;-<span class="st"> </span><span class="kw">eval_feature_representation_summary</span>(p3, s3)</a>
<a class="sourceLine" id="cb27-3" title="3"><span class="kw">print</span>(r3)</a></code></pre></div>
<pre><code>## # A tibble: 15 × 5
##    summary feature total_amount absolute_held relative_held
##    &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;
##  1 overall 1              125.         11.1          0.0891
##  2 overall 2               46.8         3.92         0.0838
##  3 overall 3              108.          9.28         0.0860
##  4 overall 4               64.0         5.37         0.0839
##  5 overall 5               85.1         7.46         0.0877
##  6 1       1               83.3         8.94         0.107 
##  7 1       2               31.2         3.13         0.100 
##  8 1       3               72.0         7.42         0.103 
##  9 1       4               42.7         4.29         0.101 
## 10 1       5               56.7         6.01         0.106 
## 11 2       1               41.6         2.19         0.0527
## 12 2       2               15.6         0.794        0.0509
## 13 2       3               36.0         1.87         0.0519
## 14 2       4               21.3         1.08         0.0505
## 15 2       5               28.4         1.44         0.0509</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="co"># plot solution</span></a>
<a class="sourceLine" id="cb29-2" title="2"><span class="kw">plot</span>(</a>
<a class="sourceLine" id="cb29-3" title="3">  <span class="kw">category_layer</span>(s3), <span class="dt">main =</span> <span class="st">&quot;solution&quot;</span>,</a>
<a class="sourceLine" id="cb29-4" title="4">  <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.1</span>, <span class="fl">1.1</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.1</span>, <span class="fl">1.1</span>), <span class="dt">axes =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb29-5" title="5">)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAeAAAAEzCAMAAADeoCAmAAACT1BMVEUAAAABAAIBAQEBAgIBBAQBBQUCAAICCQkDAAQDAwMDCwsEBAQFAAcFBQUFFBMGAAcGBgYHHRwICAgJAAsJAAwJCQkKCgoLCwsMDAwNDQ0ODg4PDw8PQ0IQDgIQEBARDwIRERESEhIUEgMUFBQVFRUXFxcYGBgaGhocGQQcHBweGwQeHh4fHx8gICAhISEhj40iIiIjIAUkJCQlJSUmJiYoKCgpATIqKiorKyssLCwuLi4vLy8yMjIzMzM0NDQ3Nzc4ODg5OTk6Ojo7Ozs9PT0+Pj4/Pz9AQEBBQUFCQkJEAVRERERFRUVISEhLS0tMTExNTU1OTk5PT09QUFBSUlJTU1NWVlZaWlpiYmJjY2NkZGRlZWVmZmZsbGxtbW1ubm5wcHBxcXF1dXV3d3d4eHh5SYR6enp8fHx9fX1+fn6BgYGCgoKDg4OEhISHh4eIiIiLi4uMjIyOjo6Pj4+QkJCRkZGSkpKUlJSVlZWYmJiZmZmbm5ucnJydnZ2fn5+hoaGjo6OkpKSlpaWmpqanp6eoqKiqqqqrq6uwsLCysrKzs7O0tLS1tbW3t7e4uLi+vr6/v7/AwMDBwcHCwsLDw8PExMTFxcXGxsbJycnKuR7MzMzPz8/Q0NDR0dHS0tLT09PV1dXX19fa2trbyCDb29vc3Nzd3d3e3t7f39/i4uLj4+Pk5OTl5eXn5+fo6Ojp6enr6+vs7Ozt7e3u7u7w8PDx8fHy8vLz8/P09PT19fX29vb39/f4+Pj5+fn6+vr7+/v8/Pz95yX9/f3+/v7////yUN1AAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIVUlEQVR4nO3d95cTVRTA8Sf23ntvi1hRLICwgiLoqKjYO/aKCPYu9oJiF9e1YEEUxVWxIKKyvD/MJDtq4j7z5sy8e2f3+v3+kDN5mc25eZ9z2CQk4DyZztU9AMkGsPEANh7AxgPYeAAbD2DjAWw8gI0HsPEANh7AxgPYeAAbzxrwOW6nzoW3585dFlj+32Qe+EHnXgHYTv8BvPjBh+uZp/ZGL/DiM3v2mHT9QPPwtztO2/uo815tHraAx7nexuFLzj3irz7auRMuy93bzut14wYuGXfInM/qewA6jVrgx1yrCau9X31y63DMPD8c+KzmLdOGltvP63UHnNS8cvTamh+HdKMW+AjX88rSq527y/u5zl24ZNGhbuuPhgO3/w5uP6/XueMfmj/WuefrfiDCjVbgtc5N/tivu+mGZ/2v27qJg96/5tyVXYE7zut1Y1Z4f69zC+p+JMKNVmA/ofHn68Trlvzh/YfO3d5c6XGndwXuOK/X9TQOlzo3r84HodCoBe4/rfULdfx7fnEL0vup7oiuwB3nNZ5kNQ77AB7BfX73zC2dO8V/4Nwdzetj3fS/gac0rr/4L+CO8wAe4b2/YMEX3n853u3n127tJm/w/nXnLs2Bx7td13h/51/ALw8td5wH8Ajvbedm9y175kA30/urnLv4zWd63Jb9OfDZzp3/1K27toAfdu62n4aW288DeIQ3eO7Q6+Bt3/L++0lDr2+bT6Faks+1rk9vAb/5z+vg9vMAHumtvX9azw5HXtjXPF532/S9jpy9pHk49JbVo5N2n7Jw6Hewv/nQ3S7Ol9vOA5hsBLDxADYewMYD2HgAGw9g4wFsPICNB7DxADYewMYD2HgAGw9g4wFsPICNB7DxADYewMYDWKzfr70y75o19U0BsFgDW5yYt337t5BXnLX3LMVvJQMs1sA2Wd4u7aBTb/1u3sl6UwAsVhi474Df/eAh76hNAbBYYeCnZzQuZj2uNgXAYoWB75vduJhzl9oUAIsVBl50euPijEfVpgBYrDDw0oMH/YaeN9SmAFisHzbaOW+zL9uWJ943+MDxG9SmqBc40y/lFDd2f3RfL8/7qn11+cyDZ3yabgtjASwHPCICGGDBEsIVLeUUAMdKCFe0lFMAHCshXNFSTgFwrIRwRUs5RQT4w768/s71b1Ym28B4AIsBf7/xjnmbrOi44Yp7Em5hLIDFgAe2OiZvu/a/LnzuojEAC5ZyilLAL90/GWDBUk5RCtj7CwAWLOUUAMdKCFe0lFMAHCshXNFSTgFwrIRwRUs5RQR4033yNgdYr5RTdAcevHd+3sJ1HTcALFnKKXirMlZCuKKlnALgWAnhipZyCoBjJYSrUOnBAI4lC1e00oMBHEsWrmilBwM4lixc0UoP1h14zcTxeSd827bcP2PPCU8k3cWuASwGPLD/J3mHt73RsXq/hd8+ufvStPvYJYDlgA9an3dsG/CLxzUu5sxPuo3dAlgZ+MeV3v88bknafewSwMrAjfqnXP5Hwk3sHsDawGuuGav33UKAm5UerAzw4KyLfki7id0DWA5433fzDmsDfmHsylWrVv2cdh+7BLAY8C+nTs075bt/Vm9p/QeZPIvWrPRgvJMVSxauaKUHAziWLFzRSg8GcCxZuKKVHgzgWLJwRSs9GMCxZOGKVnowgGPJwhWt9GAAxyoNUP7O1g+v2A8CXCKAxQMYYMEAFg9ggAUDWDyAARYMYPEABlgwgMUDGGDBABYPYIAFA1g8gAEWDGDxAAZYMIDFAxhgwUpv7cgI4Fh1C1UM4Fh1C1UM4Fh1C1UM4Fh1C1UM4Fh1C1UM4Fh1C1UM4Fh1C1UM4Fh1C1UM4Fh1C1UM4Fh1C1UM4Fh1C1UM4Fh1C1UM4Fh1C1UM4Fh1C1UM4Fh1C1UM4Fh1C1UM4Fh1C1UM4Fh1C1UM4FiltzZ0Z8U+bZVyCoBjASwewAALBrB4AAMsGMDiAQywYACLBzDAggEsHsAACwaweAADLBjA4gEMsGAAiwcwwIIBLB7AAAsGsHijFLh8xwyv4GDqu5MkgAEWTFs3A1g3bd0MYN20dTOAddPWzQDWTVs3A1g3bd0MYN20dTOAddPWzQDWTVs3A1g3bd0MYN20dTOAddPWzQDWTVs3A1g3bd0MYN20dTOAddPWzQDWTVs3A1g3bd0sCByo2H3xmaxYspbBANZM1jIYwJrJWgYDWDNZy2AAayZrGQxgzWQtgwGsmaxlMIA1k7UMBrBmspbBANZM1jIYwJrJWgYDWDNZy2AAayZrGQxgzWQtgwGsmaxlMIA1k7UMBrBmspbBANZM1jIYwJqVZgr8k0nrizmV1gS4RACLBzDAggEsHsAACwaweAADLBjA4gEMsGAAiwcwwIIBLB7AAAsGsHgAAywYwOIBDLBgAIsHMMCCld7aUAG6lJqBAI6VcrcBDgZwhQCOlXK3AQ4GcIUAjpVytwEOBnCFAI6VcrcBDgZwhQCOlXK3AQ4GcIUAjpVytwEOBnCFAI6VcrcBDgZwhQCOlXK3AQ4GcIUAjpVytwEOBnCFAI4V+mjV8AJbG7qzYsCBAvcFcJoAFg9ggAUDWDyAARYMYPEABlgwgMUDGGDBABYPYIAFA1g8gAEWDGDxAAZYMIDFAxhgwQAWD2CAaTQHsPEANh7AxgPYeAAbD2DjAWw8gI0HsPEANh7AxgPYeAAbD2DjAWw8gI0HsPEANh7AxgPYeAAbD2DjAWw8gI0HsPEANh7AxgPYeAAbD2DjAWw8gI0HsPEANh7AxgPYeAAbD2DjAWw8gI0HsPEANh7AxgPYeAAbD2DjAWw8gI0HsPEANh7AxgPYeAAbD2DjAWw8gI0HsPH+BGYKb7ZKKYPJAAAAAElFTkSuQmCC" style="display: block; margin: auto;" /></p>
</div>
<div id="multiple-zones-with-complex-targets" class="section level3">
<h3>Multiple zones with complex targets</h3>
<p>So far, we have dealt with problems where each feature has a target that pertains to a single zone. But sometimes we have targets that pertain to multiple zones. For example, what if we were in charge of managing pest control in a set of areas and we had three different pest control methods we could implement in any given planning unit. We could (i) set up a few traps in a given planning unit and make 10 % of the habitat in the unit pest-free, (ii) set up a lot of traps and make 50 % of the habitat in the unit pest-free, or (iii) drop baits over a given planning unit and make 80 % of the planning unit pest-free. Each of these different actions has a different cost, with a few low intensity trapping costing $100 per planning unit, a high intensity trapping costing $300, and baiting costing $200 (please note these costs aren’t meant to be realistic). After defining our management actions and costs, we require a solution that will yield 8 units of pest free habitat per feature. It’s important to note that unlike the previous examples, here we don’t have targets for each feature in each zone, but rather our targets are for each feature and across multiple zones. In other words, we don’t really care which management actions we implement, we just want the set of actions that will meet our targets for minimum expenditure. We can formulate and solve this problem using the following code.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1"><span class="co"># create planning unit data with costs</span></a>
<a class="sourceLine" id="cb30-2" title="2">pu4 &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb30-3" title="3">  <span class="kw">as.int</span>(<span class="op">!</span><span class="kw">is.na</span>(sim_pu_raster)) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>,</a>
<a class="sourceLine" id="cb30-4" title="4">  <span class="kw">as.int</span>(<span class="op">!</span><span class="kw">is.na</span>(sim_pu_raster)) <span class="op">*</span><span class="st"> </span><span class="dv">300</span>,</a>
<a class="sourceLine" id="cb30-5" title="5">  <span class="kw">as.int</span>(<span class="op">!</span><span class="kw">is.na</span>(sim_pu_raster)) <span class="op">*</span><span class="st"> </span><span class="dv">200</span></a>
<a class="sourceLine" id="cb30-6" title="6">)</a>
<a class="sourceLine" id="cb30-7" title="7"><span class="kw">names</span>(pu4) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;few traps&quot;</span>, <span class="st">&quot;many traps&quot;</span>, <span class="st">&quot;baiting&quot;</span>)</a>
<a class="sourceLine" id="cb30-8" title="8"></a>
<a class="sourceLine" id="cb30-9" title="9"><span class="co"># plot planning unit data</span></a>
<a class="sourceLine" id="cb30-10" title="10"><span class="kw">plot</span>(</a>
<a class="sourceLine" id="cb30-11" title="11">  pu4, <span class="dt">nr =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb30-12" title="12">  <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.1</span>, <span class="fl">1.1</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.1</span>, <span class="fl">1.1</span>), <span class="dt">axes =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb30-13" title="13">)</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"><span class="co"># create targets</span></a>
<a class="sourceLine" id="cb31-2" title="2">t4 &lt;-<span class="st"> </span><span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb31-3" title="3">  <span class="dt">feature =</span> <span class="kw">names</span>(sim_features),</a>
<a class="sourceLine" id="cb31-4" title="4">  <span class="dt">zone =</span> <span class="kw">list</span>(<span class="kw">names</span>(pu4))[<span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">5</span>)],</a>
<a class="sourceLine" id="cb31-5" title="5">  <span class="dt">target =</span> <span class="kw">rep</span>(<span class="dv">8</span>, <span class="dv">5</span>),</a>
<a class="sourceLine" id="cb31-6" title="6">  <span class="dt">type =</span> <span class="kw">rep</span>(<span class="st">&quot;absolute&quot;</span>, <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb31-7" title="7">)</a>
<a class="sourceLine" id="cb31-8" title="8"></a>
<a class="sourceLine" id="cb31-9" title="9"><span class="co"># print targets</span></a>
<a class="sourceLine" id="cb31-10" title="10"><span class="kw">print</span>(t4)</a></code></pre></div>
<pre><code>## # A tibble: 5 × 4
##   feature   zone      target type    
##   &lt;chr&gt;     &lt;list&gt;     &lt;dbl&gt; &lt;chr&gt;   
## 1 feature_1 &lt;chr [3]&gt;      8 absolute
## 2 feature_2 &lt;chr [3]&gt;      8 absolute
## 3 feature_3 &lt;chr [3]&gt;      8 absolute
## 4 feature_4 &lt;chr [3]&gt;      8 absolute
## 5 feature_5 &lt;chr [3]&gt;      8 absolute</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1"><span class="co"># create problem</span></a>
<a class="sourceLine" id="cb33-2" title="2">p4 &lt;-</a>
<a class="sourceLine" id="cb33-3" title="3"><span class="st">  </span><span class="kw">problem</span>(</a>
<a class="sourceLine" id="cb33-4" title="4">    pu4,</a>
<a class="sourceLine" id="cb33-5" title="5">    <span class="kw">zones</span>(</a>
<a class="sourceLine" id="cb33-6" title="6">      sim_features <span class="op">*</span><span class="st"> </span><span class="fl">0.1</span>,</a>
<a class="sourceLine" id="cb33-7" title="7">      sim_features <span class="op">*</span><span class="st"> </span><span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb33-8" title="8">      sim_features <span class="op">*</span><span class="st"> </span><span class="fl">0.8</span>,</a>
<a class="sourceLine" id="cb33-9" title="9">      <span class="dt">zone_names =</span> <span class="kw">names</span>(pu4),</a>
<a class="sourceLine" id="cb33-10" title="10">      <span class="dt">feature_names =</span> <span class="kw">names</span>(sim_features)</a>
<a class="sourceLine" id="cb33-11" title="11">    )</a>
<a class="sourceLine" id="cb33-12" title="12">  ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb33-13" title="13"><span class="st">  </span><span class="kw">add_min_set_objective</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb33-14" title="14"><span class="st">  </span><span class="kw">add_manual_targets</span>(t4) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb33-15" title="15"><span class="st">  </span><span class="kw">add_binary_decisions</span>()</a>
<a class="sourceLine" id="cb33-16" title="16"></a>
<a class="sourceLine" id="cb33-17" title="17"><span class="co"># print problem</span></a>
<a class="sourceLine" id="cb33-18" title="18"><span class="kw">print</span>(p4)</a></code></pre></div>
<pre><code>## A conservation problem (&lt;ConservationProblem&gt;)
## ├•data
## │├•zones:       &quot;few traps&quot;, &quot;many traps&quot;, and &quot;baiting&quot; (3 total)
## │├•features:    &quot;feature_1&quot;, &quot;feature_2&quot;, &quot;feature_3&quot;, &quot;feature_4&quot;, and &quot;feature_5&quot; (5 total)
## │└•planning units:
## │ ├•data:       &lt;SpatRaster&gt; (100 total)
## │ ├•costs:      continuous values (between 0 and 300)
## │ ├•extent:     0, 0, 1, 1 (xmin, ymin, xmax, ymax)
## │ └•CRS:        Undefined Cartesian SRS (projected)
## ├•formulation
## │├•objective:   minimum set objective
## │├•penalties:   none specified
## │├•targets:     absolute targets (between 8 and 8)
## │├•constraints: none specified
## │└•decisions:   binary decision
## └•optimization
##  ├•portfolio:   default portfolio
##  └•solver:      gurobi solver (`gap` = 0.1, `time_limit` = 2147483647, `first_feasible` = FALSE, …)
## # ℹ Use `summary(...)` to see complete formulation.</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1"><span class="co"># solve problem</span></a>
<a class="sourceLine" id="cb35-2" title="2">s4 &lt;-<span class="st"> </span><span class="kw">solve</span>(p4)</a></code></pre></div>
<pre><code>## Set parameter Username
## Set parameter TimeLimit to value 2147483647
## Set parameter MIPGap to value 0.1
## Set parameter Presolve to value 2
## Set parameter Threads to value 1
## Academic license - for non-commercial use only - expires 2025-06-05
## Gurobi Optimizer version 11.0.0 build v11.0.0rc2 (linux64 - &quot;Ubuntu 20.04.6 LTS&quot;)
## 
## CPU model: AMD Ryzen Threadripper 3960X 24-Core Processor, instruction set [SSE2|AVX|AVX2]
## Thread count: 24 physical cores, 48 logical processors, using up to 1 threads
## 
## Optimize a model with 105 rows, 300 columns and 1800 nonzeros
## Model fingerprint: 0xba527df5
## Variable types: 0 continuous, 300 integer (300 binary)
## Coefficient statistics:
##   Matrix range     [2e-02, 1e+00]
##   Objective range  [1e+02, 3e+02]
##   Bounds range     [1e+00, 1e+00]
##   RHS range        [1e+00, 8e+00]
## Found heuristic solution: objective 9400.0000000
## Presolve removed 14 rows and 120 columns
## Presolve time: 0.00s
## Presolved: 91 rows, 180 columns, 360 nonzeros
## Found heuristic solution: objective 4700.0000000
## Variable types: 0 continuous, 180 integer (180 binary)
## Root relaxation presolved: 91 rows, 180 columns, 360 nonzeros
## 
## 
## Root relaxation: objective 3.663237e+03, 1 iterations, 0.00 seconds (0.00 work units)
## 
##     Nodes    |    Current Node    |     Objective Bounds      |     Work
##  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
## 
##      0     0 3663.23656    0    1 4700.00000 3663.23656  22.1%     -    0s
## H    0     0                    3800.0000000 3663.23656  3.60%     -    0s
## 
## Explored 1 nodes (1 simplex iterations) in 0.00 seconds (0.00 work units)
## Thread count was 1 (of 48 available processors)
## 
## Solution count 3: 3800 4700 9400 
## 
## Optimal solution found (tolerance 1.00e-01)
## Best objective 3.800000000000e+03, best bound 3.700000000000e+03, gap 2.6316%</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1"><span class="co"># calculate feature representation</span></a>
<a class="sourceLine" id="cb37-2" title="2">r4 &lt;-<span class="st"> </span><span class="kw">eval_feature_representation_summary</span>(p4, s4)</a>
<a class="sourceLine" id="cb37-3" title="3"><span class="kw">print</span>(r4)</a></code></pre></div>
<pre><code>## # A tibble: 20 × 5
##    summary    feature   total_amount absolute_held relative_held
##    &lt;chr&gt;      &lt;chr&gt;            &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;
##  1 overall    feature_1       117.           18.3          0.157
##  2 overall    feature_2        43.7           8.19         0.187
##  3 overall    feature_3       101.           15.2          0.151
##  4 overall    feature_4        59.7          11.6          0.194
##  5 overall    feature_5        79.4          12.7          0.161
##  6 few traps  feature_1         8.33          0            0    
##  7 few traps  feature_2         3.12          0            0    
##  8 few traps  feature_3         7.20          0            0    
##  9 few traps  feature_4         4.27          0            0    
## 10 few traps  feature_5         5.67          0            0    
## 11 many traps feature_1        41.6           0            0    
## 12 many traps feature_2        15.6           0            0    
## 13 many traps feature_3        36.0           0            0    
## 14 many traps feature_4        21.3           0            0    
## 15 many traps feature_5        28.4           0            0    
## 16 baiting    feature_1        66.6          18.3          0.275
## 17 baiting    feature_2        25.0           8.19         0.328
## 18 baiting    feature_3        57.6          15.2          0.264
## 19 baiting    feature_4        34.1          11.6          0.340
## 20 baiting    feature_5        45.4          12.7          0.281</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1"><span class="co"># plot solution</span></a>
<a class="sourceLine" id="cb39-2" title="2"><span class="kw">plot</span>(<span class="kw">category_layer</span>(s4), <span class="dt">main =</span> <span class="st">&quot;solution&quot;</span>, <span class="dt">axes =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="multiple-zones-with-extra-constraints" class="section level3">
<h3>Multiple zones with extra constraints</h3>
<p>So it looks like baiting is the way to go! Except that we might recall that we can’t use baits in most of the planning units because they contain native species that are susceptible to baits. So now we need to specify which of our planning units cannot be assigned to the third zone (baiting) to obtain a more useful solution.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1"><span class="co"># create data.frame to specify that we cannot bait in the first 80 units</span></a>
<a class="sourceLine" id="cb40-2" title="2">l5 &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">pu =</span> <span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">80</span>), <span class="dt">zone =</span> <span class="st">&quot;baiting&quot;</span>, <span class="dt">status =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb40-3" title="3"></a>
<a class="sourceLine" id="cb40-4" title="4"><span class="co"># preview locked data</span></a>
<a class="sourceLine" id="cb40-5" title="5"><span class="kw">head</span>(l5)</a></code></pre></div>
<pre><code>## # A tibble: 6 × 3
##      pu zone    status
##   &lt;int&gt; &lt;chr&gt;    &lt;dbl&gt;
## 1     1 baiting      0
## 2     2 baiting      0
## 3     3 baiting      0
## 4     4 baiting      0
## 5     5 baiting      0
## 6     6 baiting      0</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1"><span class="co"># create problem</span></a>
<a class="sourceLine" id="cb42-2" title="2">p5 &lt;-</a>
<a class="sourceLine" id="cb42-3" title="3"><span class="st">  </span><span class="kw">problem</span>(</a>
<a class="sourceLine" id="cb42-4" title="4">    pu4,</a>
<a class="sourceLine" id="cb42-5" title="5">    <span class="kw">zones</span>(</a>
<a class="sourceLine" id="cb42-6" title="6">      sim_features <span class="op">*</span><span class="st"> </span><span class="fl">0.1</span>,</a>
<a class="sourceLine" id="cb42-7" title="7">      sim_features <span class="op">*</span><span class="st"> </span><span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb42-8" title="8">      sim_features <span class="op">*</span><span class="st"> </span><span class="fl">0.8</span>,</a>
<a class="sourceLine" id="cb42-9" title="9">      <span class="dt">zone_names =</span> <span class="kw">names</span>(pu4),</a>
<a class="sourceLine" id="cb42-10" title="10">      <span class="dt">feature_names =</span> <span class="kw">names</span>(sim_features)</a>
<a class="sourceLine" id="cb42-11" title="11">    )</a>
<a class="sourceLine" id="cb42-12" title="12">  ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb42-13" title="13"><span class="st">  </span><span class="kw">add_min_set_objective</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb42-14" title="14"><span class="st">  </span><span class="kw">add_manual_targets</span>(t4) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb42-15" title="15"><span class="st">  </span><span class="kw">add_manual_locked_constraints</span>(l5) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb42-16" title="16"><span class="st">  </span><span class="kw">add_binary_decisions</span>()</a>
<a class="sourceLine" id="cb42-17" title="17"></a>
<a class="sourceLine" id="cb42-18" title="18"><span class="co"># print problem</span></a>
<a class="sourceLine" id="cb42-19" title="19"><span class="kw">print</span>(p5)</a></code></pre></div>
<pre><code>## A conservation problem (&lt;ConservationProblem&gt;)
## ├•data
## │├•zones:       &quot;few traps&quot;, &quot;many traps&quot;, and &quot;baiting&quot; (3 total)
## │├•features:    &quot;feature_1&quot;, &quot;feature_2&quot;, &quot;feature_3&quot;, &quot;feature_4&quot;, and &quot;feature_5&quot; (5 total)
## │└•planning units:
## │ ├•data:       &lt;SpatRaster&gt; (100 total)
## │ ├•costs:      continuous values (between 0 and 300)
## │ ├•extent:     0, 0, 1, 1 (xmin, ymin, xmax, ymax)
## │ └•CRS:        Undefined Cartesian SRS (projected)
## ├•formulation
## │├•objective:   minimum set objective
## │├•penalties:   none specified
## │├•targets:     absolute targets (between 8 and 8)
## │├•constraints:
## ││└•1:          manual locked constraints (80 planning units)
## │└•decisions:   binary decision
## └•optimization
##  ├•portfolio:   default portfolio
##  └•solver:      gurobi solver (`gap` = 0.1, `time_limit` = 2147483647, `first_feasible` = FALSE, …)
## # ℹ Use `summary(...)` to see complete formulation.</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1"><span class="co"># solve problem</span></a>
<a class="sourceLine" id="cb44-2" title="2">s5 &lt;-<span class="st"> </span><span class="kw">solve</span>(p5)</a></code></pre></div>
<pre><code>## Set parameter Username
## Set parameter TimeLimit to value 2147483647
## Set parameter MIPGap to value 0.1
## Set parameter Presolve to value 2
## Set parameter Threads to value 1
## Academic license - for non-commercial use only - expires 2025-06-05
## Gurobi Optimizer version 11.0.0 build v11.0.0rc2 (linux64 - &quot;Ubuntu 20.04.6 LTS&quot;)
## 
## CPU model: AMD Ryzen Threadripper 3960X 24-Core Processor, instruction set [SSE2|AVX|AVX2]
## Thread count: 24 physical cores, 48 logical processors, using up to 1 threads
## 
## Optimize a model with 105 rows, 300 columns and 1800 nonzeros
## Model fingerprint: 0x0d87ce25
## Variable types: 0 continuous, 300 integer (300 binary)
## Coefficient statistics:
##   Matrix range     [2e-02, 1e+00]
##   Objective range  [1e+02, 3e+02]
##   Bounds range     [1e+00, 1e+00]
##   RHS range        [1e+00, 8e+00]
## Found heuristic solution: objective 13600.000000
## Presolve removed 14 rows and 120 columns
## Presolve time: 0.00s
## Presolved: 91 rows, 180 columns, 360 nonzeros
## Found heuristic solution: objective 9600.0000000
## Variable types: 0 continuous, 180 integer (180 binary)
## Root relaxation presolved: 91 rows, 180 columns, 360 nonzeros
## 
## 
## Root relaxation: objective 6.938068e+03, 1 iterations, 0.00 seconds (0.00 work units)
## 
##     Nodes    |    Current Node    |     Objective Bounds      |     Work
##  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
## 
##      0     0 6938.06815    0    1 9600.00000 6938.06815  27.7%     -    0s
## H    0     0                    7000.0000000 6938.06815  0.88%     -    0s
##      0     0 6938.06815    0    1 7000.00000 6938.06815  0.88%     -    0s
## 
## Explored 1 nodes (1 simplex iterations) in 0.00 seconds (0.00 work units)
## Thread count was 1 (of 48 available processors)
## 
## Solution count 3: 7000 9600 13600 
## 
## Optimal solution found (tolerance 1.00e-01)
## Best objective 7.000000000000e+03, best bound 7.000000000000e+03, gap 0.0000%</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1"><span class="co"># calculate feature representation</span></a>
<a class="sourceLine" id="cb46-2" title="2">r5 &lt;-<span class="st"> </span><span class="kw">eval_feature_representation_summary</span>(p5, s5)</a>
<a class="sourceLine" id="cb46-3" title="3"><span class="kw">print</span>(r5)</a></code></pre></div>
<pre><code>## # A tibble: 20 × 5
##    summary    feature   total_amount absolute_held relative_held
##    &lt;chr&gt;      &lt;chr&gt;            &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;
##  1 overall    feature_1       117.           21.8          0.187
##  2 overall    feature_2        43.7           8.04         0.184
##  3 overall    feature_3       101.           17.7          0.176
##  4 overall    feature_4        59.7          10.9          0.182
##  5 overall    feature_5        79.4          15.2          0.192
##  6 few traps  feature_1         8.33          0            0    
##  7 few traps  feature_2         3.12          0            0    
##  8 few traps  feature_3         7.20          0            0    
##  9 few traps  feature_4         4.27          0            0    
## 10 few traps  feature_5         5.67          0            0    
## 11 many traps feature_1        41.6           7.40         0.178
## 12 many traps feature_2        15.6           3.42         0.219
## 13 many traps feature_3        36.0           6.00         0.167
## 14 many traps feature_4        21.3           4.84         0.227
## 15 many traps feature_5        28.4           5.26         0.186
## 16 baiting    feature_1        66.6          14.4          0.217
## 17 baiting    feature_2        25.0           4.62         0.185
## 18 baiting    feature_3        57.6          11.7          0.203
## 19 baiting    feature_4        34.1           6.05         0.177
## 20 baiting    feature_5        45.4           9.98         0.220</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1"><span class="co"># plot solution</span></a>
<a class="sourceLine" id="cb48-2" title="2"><span class="kw">plot</span>(<span class="kw">category_layer</span>(s5), <span class="dt">main =</span> <span class="st">&quot;solution&quot;</span>, <span class="dt">axes =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="multiple-zones-with-fragmentation-penalties" class="section level3">
<h3>Multiple zones with fragmentation penalties</h3>
<p>So now the best strategy seems to be a combination of high intensity trapping and baiting. But we can also see that this solution is fairly fragmented, so we can add penalties to cluster managed planning units together. Here we will add penalties that will cluster the planning units allocated to the two trapping zones together, and penalties that will cluster the planning units allocated to the baiting zone together. We will also set an overall penalty factor to 640 to strongly penalize fragmented solutions.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" title="1"><span class="co"># create matrix that describes boundary penalties between planning units</span></a>
<a class="sourceLine" id="cb49-2" title="2"><span class="co"># allocated to different zones</span></a>
<a class="sourceLine" id="cb49-3" title="3">z6 &lt;-<span class="st"> </span><span class="kw">diag</span>(<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb49-4" title="4">z6[<span class="dv">1</span>, <span class="dv">2</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb49-5" title="5">z6[<span class="dv">2</span>, <span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb49-6" title="6"><span class="kw">colnames</span>(z6) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;few traps&quot;</span>, <span class="st">&quot;many traps&quot;</span>, <span class="st">&quot;baiting&quot;</span>)</a>
<a class="sourceLine" id="cb49-7" title="7"><span class="kw">rownames</span>(z6) &lt;-<span class="st"> </span><span class="kw">colnames</span>(z6)</a>
<a class="sourceLine" id="cb49-8" title="8"></a>
<a class="sourceLine" id="cb49-9" title="9"><span class="co"># print matrix</span></a>
<a class="sourceLine" id="cb49-10" title="10"><span class="kw">print</span>(z6)</a></code></pre></div>
<pre><code>##            few traps many traps baiting
## few traps          1          1       0
## many traps         1          1       0
## baiting            0          0       1</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" title="1"><span class="co"># create problem</span></a>
<a class="sourceLine" id="cb51-2" title="2">p6 &lt;-</a>
<a class="sourceLine" id="cb51-3" title="3"><span class="st">  </span><span class="kw">problem</span>(</a>
<a class="sourceLine" id="cb51-4" title="4">    pu4,</a>
<a class="sourceLine" id="cb51-5" title="5">    <span class="kw">zones</span>(</a>
<a class="sourceLine" id="cb51-6" title="6">      sim_features <span class="op">*</span><span class="st"> </span><span class="fl">0.1</span>,</a>
<a class="sourceLine" id="cb51-7" title="7">      sim_features <span class="op">*</span><span class="st"> </span><span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb51-8" title="8">      sim_features <span class="op">*</span><span class="st"> </span><span class="fl">0.8</span>,</a>
<a class="sourceLine" id="cb51-9" title="9">      <span class="dt">zone_names =</span> <span class="kw">names</span>(pu4),</a>
<a class="sourceLine" id="cb51-10" title="10">      <span class="dt">feature_names =</span> <span class="kw">names</span>(sim_features)</a>
<a class="sourceLine" id="cb51-11" title="11">    )</a>
<a class="sourceLine" id="cb51-12" title="12">  ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb51-13" title="13"><span class="st">  </span><span class="kw">add_min_set_objective</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb51-14" title="14"><span class="st">  </span><span class="kw">add_manual_targets</span>(t4) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb51-15" title="15"><span class="st">  </span><span class="kw">add_manual_locked_constraints</span>(l5) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb51-16" title="16"><span class="st">  </span><span class="kw">add_boundary_penalties</span>(<span class="dt">penalty =</span> <span class="dv">640</span>, <span class="dt">zones =</span> z6) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb51-17" title="17"><span class="st">  </span><span class="kw">add_binary_decisions</span>()</a>
<a class="sourceLine" id="cb51-18" title="18"></a>
<a class="sourceLine" id="cb51-19" title="19"><span class="co"># print problem</span></a>
<a class="sourceLine" id="cb51-20" title="20"><span class="kw">print</span>(p6)</a></code></pre></div>
<pre><code>## A conservation problem (&lt;ConservationProblem&gt;)
## ├•data
## │├•zones:       &quot;few traps&quot;, &quot;many traps&quot;, and &quot;baiting&quot; (3 total)
## │├•features:    &quot;feature_1&quot;, &quot;feature_2&quot;, &quot;feature_3&quot;, &quot;feature_4&quot;, and &quot;feature_5&quot; (5 total)
## │└•planning units:
## │ ├•data:       &lt;SpatRaster&gt; (100 total)
## │ ├•costs:      continuous values (between 0 and 300)
## │ ├•extent:     0, 0, 1, 1 (xmin, ymin, xmax, ymax)
## │ └•CRS:        Undefined Cartesian SRS (projected)
## ├•formulation
## │├•objective:   minimum set objective
## │├•penalties:
## ││└•1:          boundary penalties (`penalty` = 640, `edge_factor` = 0.5, 0.5, and 0.5, …)
## │├•targets:     absolute targets (between 8 and 8)
## │├•constraints:
## ││└•1:          manual locked constraints (80 planning units)
## │└•decisions:   binary decision
## └•optimization
##  ├•portfolio:   default portfolio
##  └•solver:      gurobi solver (`gap` = 0.1, `time_limit` = 2147483647, `first_feasible` = FALSE, …)
## # ℹ Use `summary(...)` to see complete formulation.</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" title="1"><span class="co"># solve problem</span></a>
<a class="sourceLine" id="cb53-2" title="2">s6 &lt;-<span class="st"> </span><span class="kw">solve</span>(p6)</a></code></pre></div>
<pre><code>## Set parameter Username
## Set parameter TimeLimit to value 2147483647
## Set parameter MIPGap to value 0.1
## Set parameter Presolve to value 2
## Set parameter Threads to value 1
## Academic license - for non-commercial use only - expires 2025-06-05
## Gurobi Optimizer version 11.0.0 build v11.0.0rc2 (linux64 - &quot;Ubuntu 20.04.6 LTS&quot;)
## 
## CPU model: AMD Ryzen Threadripper 3960X 24-Core Processor, instruction set [SSE2|AVX|AVX2]
## Thread count: 24 physical cores, 48 logical processors, using up to 1 threads
## 
## Optimize a model with 1905 rows, 1200 columns and 5400 nonzeros
## Model fingerprint: 0xcf2ec927
## Variable types: 0 continuous, 1200 integer (1200 binary)
## Coefficient statistics:
##   Matrix range     [2e-02, 1e+00]
##   Objective range  [1e+02, 6e+02]
##   Bounds range     [1e+00, 1e+00]
##   RHS range        [1e+00, 8e+00]
## Found heuristic solution: objective 20096.000000
## Presolve removed 1028 rows and 232 columns
## Presolve time: 0.02s
## Presolved: 877 rows, 968 columns, 2712 nonzeros
## Variable types: 0 continuous, 968 integer (968 binary)
## Found heuristic solution: objective 19632.000000
## Root relaxation presolved: 877 rows, 968 columns, 2712 nonzeros
## 
## 
## Root relaxation: objective 1.005410e+04, 568 iterations, 0.01 seconds (0.01 work units)
## 
##     Nodes    |    Current Node    |     Objective Bounds      |     Work
##  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
## 
##      0     0 10054.0986    0   57 19632.0000 10054.0986  48.8%     -    0s
## H    0     0                    11300.000000 10054.0986  11.0%     -    0s
## H    0     0                    11172.000000 10054.0986  10.0%     -    0s
## 
## Explored 1 nodes (840 simplex iterations) in 0.03 seconds (0.04 work units)
## Thread count was 1 (of 48 available processors)
## 
## Solution count 4: 11172 11300 19632 20096 
## 
## Optimal solution found (tolerance 1.00e-01)
## Best objective 1.117200000000e+04, best bound 1.005600000000e+04, gap 9.9893%</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" title="1"><span class="co"># calculate feature representation</span></a>
<a class="sourceLine" id="cb55-2" title="2">r6 &lt;-<span class="st"> </span><span class="kw">eval_feature_representation_summary</span>(p6, s6)</a>
<a class="sourceLine" id="cb55-3" title="3"><span class="kw">print</span>(r6)</a></code></pre></div>
<pre><code>## # A tibble: 20 × 5
##    summary    feature   total_amount absolute_held relative_held
##    &lt;chr&gt;      &lt;chr&gt;            &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;
##  1 overall    feature_1       117.           22.5          0.193
##  2 overall    feature_2        43.7           8.00         0.183
##  3 overall    feature_3       101.           18.0          0.179
##  4 overall    feature_4        59.7          11.3          0.190
##  5 overall    feature_5        79.4          15.8          0.198
##  6 few traps  feature_1         8.33          0            0    
##  7 few traps  feature_2         3.12          0            0    
##  8 few traps  feature_3         7.20          0            0    
##  9 few traps  feature_4         4.27          0            0    
## 10 few traps  feature_5         5.67          0            0    
## 11 many traps feature_1        41.6           8.08         0.194
## 12 many traps feature_2        15.6           3.39         0.217
## 13 many traps feature_3        36.0           6.32         0.176
## 14 many traps feature_4        21.3           5.27         0.247
## 15 many traps feature_5        28.4           5.77         0.204
## 16 baiting    feature_1        66.6          14.4          0.217
## 17 baiting    feature_2        25.0           4.62         0.185
## 18 baiting    feature_3        57.6          11.7          0.203
## 19 baiting    feature_4        34.1           6.05         0.177
## 20 baiting    feature_5        45.4           9.98         0.220</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" title="1"><span class="co"># plot solution</span></a>
<a class="sourceLine" id="cb57-2" title="2"><span class="kw">plot</span>(<span class="kw">category_layer</span>(s6), <span class="dt">main =</span> <span class="st">&quot;solution&quot;</span>, <span class="dt">axes =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAeAAAAEzCAMAAADeoCAmAAACcFBMVEUAAAABAAIBAQEBAgIBBAQBBQUCAAICCQkDAAQDAwMDCwsEBAQFAAcFBQUFFBMGAAcGBgYHBwcHHRwICAgJAAsJAAwJCQkKCgoLCwsMDAwNDQ0ODg4PDw8PQ0IQDgIQEBARDwIRERESEhIUEgMUFBQVFRUXFxcYGBgaGhocGQQcHBweGwQeHh4fHx8gICAhISEhj40iIiIjIAUkJCQlJSUmJiYoKCgpATIqKiorKyssLCwuLi4vLy8xMTEyMjIzMzM0NDQ3Nzc3mpg4ODg5OTk6Ojo7Ozs9PT0+Pj4/Pz9AQEBBQUFCQkJEAVRERERFRUVISEhLS0tMTExNTU1OTk5PT09SUlJTU1NWGmVWVlZaWlpiYmJjY2NkZGRmZmZsbGxtbW1ubm5wcHBxcXF1dXV2dnZ3d3d4eHh5u7p6enp8fHx9fX1+fn6BgYGCgoKDg4OEhISHh4eIiIiLi4uMjIyOZpiOjo6Pj4+RkZGSkpKUlJSVlZWYmJiZmZmadqKbm5ucnJydnZ2fn5+hoaGjo6OkpKSlpaWmpqanp6eoqKiqqqqrq6usrKywsLCxsbGysrKzs7O0tLS1tbW3t7e4uLi+vr6/v7/AwMDBwcHCwsLDw8PExMTFxcXGxsbJycnKuR7MzMzPz8/Q0NDR0dHS0tLT09PV1dXX19fY2Nja2trbyCDb29vc3Nzd3d3e3t7f39/g4ODh4eHi4uLj4+Pk5OTl5eXn5+fo6Ojr6+vs7Ozt7e3u7u7w8PDx8fHy8vLz8/P09PT19fX29vb39/f4+Pj5+fn6+vr7+/v8/Pz95yX96Tr9/f3+8Xz+8or+/v7////DyyGyAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJKUlEQVR4nO3c+5+UdRXA8W90NbObJWgWWeoSaUYhBQisSSJUFhWaXUzoXpqEhFqUqVnZVdG1Mtu2LbObUWmxApaApLbF919qdnZoZ8XvPM/zPd9zZvbw+fwwr2cezuvZnfPeF7M7+5oNkVwX+v0JkG4AOw9g5wHsPICdB7DzAHYewM4D2HkAOw9g5wHsPICdB7DzvAG/L5w8+8R9W7Y88Aynj5vcA+8M4W6A/ZQA3rXzpv58Pn1v7gLvevfQqSs+PTF1+K9rLz79TR+4Z+qwDbw4DLcO7wzhG/Gq80JY9tGOe9fccFg88eHFZ236Y/8egE1zFviW0G7p/hj3X9A+nLc1Hgt86dS/XDR9untuOJzx9qk75x3q8+PQbs4CnxOG7h69KoTrYtwSwmUjt50dTvzNscDdz8Hdc8MhnP+1bYtC+EG/H4hycxX4UAgrfxcPf+4z342PnxSWT8b44xCu7Ak8a244zNsd4w0hbO/3I1FurgLHpa3/X5d/cuTJGO8P4YtTZ4bCJT2BZ80Nh6HW4WgIW/v5IAyas8DjF7efUJf8Mu5qQ8a4JpzTE3jWXOubrNbhGMAD3J+uX39CCBfGX4dw7dT9RWHt/4FXt+7f8TTgWXMAD3i/2r79rzE+tCQsjIdODCuPxPiTED7SAV4STjkQ45eOAt81fXrWHMAD3n0hbBx74PbXhfUxfjyEK+69fSicMN4Bfm8IH/z21ae0gW8K4Zp/Tp/ungN4wJt8//TPwSf9LMZ9K6Z/vp36Fqot+b32/bVt4Htnfg7ungN40Dv0lYuGXnruZWNTx4evWfuqczeOTB1Ov2R184oFq3dMPwfHz589/4rO6a45gMlHADsPYOcB7DyAnQew8wB2HsDOA9h5hsBftu+zJWr0Eb9ut896GQK/x743l6jRR/yQ3T7rBTDApVJC7BXAAANcLCXEXgEMMMDFUkLsFcAAA1wsJcReAQwwwMVSQuxVX4Gf+MSVnTYfsNvy0wNYDXjiBW/r9JLudyHvvvT0DYbvSgZYD/hFR0++sht0zdV7t15gt3WAjYHHzngiTp71c7OtA2wM/J11rZsNt5ptHWBj4Bs3tm42XWe2dYCNgW+7pHXzrpvNtg6wMfDomZPxyNBPzbYOsBrwo896RafnPdS1huU3Tn71/CNmWwdYDTj+/cFOf+tew4Prz1z3B7utA6wHPBABDHCplBB71YysxFfDO+z2WS+AK6cBrpkpbU+yZtMA18yUtidZs+ls4PvHOo3bLfmYAK6czgXe9+yXd3rO7q41jK87bek37bYOcOV0LvDEC4+efHHXK1n7F+545FsLRs22DnDldFngO97autm0zWzrAFdOlwX+x8MxPrZ4xGzrAFdOlwVuNb76Y0+abR3gyunCwAc2L7L7ZSHANabLAk9uuPxRu50DXGM6G/i5r+70/C7gHy16eM+ePY+ZbR3gyulc4MkbtnXacXjm7Bfaf/GW76LL1FfgwQjgymmAa2ZK25Os2TTANTOl7UnWbBrgmpnS9iRrNg1wzUxpe5I1mwa4Zqa0PcmaTecCH1i+pNOyR7rW8P1l81fZvRQNcPV0LvDEa3/f6Y1dL3T8+bQf7t268KDZ1gGunM4Gfv1Tnd7SBXzX5TEenGf3BmGAK6fLAsf4+Oin1tpt3Tdws0p8OdQA/suGk6/nrSv9yAg4xn2n3mO2dYBnMgHesbl1s2qn2dYBnqk08Gt+0ekNXcAj8+/cd8vLfmu2dYBnKgx88J1rOl24t2sNt65csGqX3dYBnqkw8GAE8EwAyzLFyglgWaZYOQEsyxQrJ4BlmWLlBLAsU6ycAJZlipUTwLJMsXICWJYpVk4AyzLFyglgWaZYOQEsyxQrJ4BlmWLlBLAsU6ycAJZlipUTwLJMsXICWJYpVk4AyzLFyikB3MidPyc8wAEsy1YrI4Bl2WplBLAsW62MAJZlq5URwLJstTICWJatVkYAy7LVyghgWbZaGQEsy1YrI4Bl2WplBLAsW62MAJZlq5URwLJstTICWJatVkYAy7LVyghgWbZaGQEsy1YrI4Bl2WplBLAsW62MAJZlq5URwLJstTICWJatVrtGNgALU2NMBzDA1dMA10yNMR3AAFdPA1wzNcZ0AANcPQ1wzdQY0wEMcPU0wDVTY0wHMMDV0wDXTI0xHcAAV08DXDM1xnQAA1w9DXDN1BjTAQxw9TTANVNjTAcwwNXTANdMjTEdwABXTwNcMzXGdAADXD0NcM3UGNMB7By4Wc2+HJ45gAc4gGUpsZQLYFlKLOUCWJYSS7kAlqXEUi6AZSmxlAtgWUos5QJYlhJLuQCWpcRSLoBlKbGUC2BZSizlAliWEku5AJalxFIugGUpsZQLYFlKLOUCWJYSS7kAlqXEUi6AZSmxlAtgWUos5QJYlhJLuQCWpcRSLoBlKbGUC2BZSiztStgALKzZtpsFcCqAy14EYJ0ATgVw2YsArBPAqQAuexGAdQI4FcBlLwKwTgCnArjsRQDWCeBUAJe9CMA6AZwK4LIXAVgngFMBXPYiAOsEcCqAy14EYJ0ATgVw2YsArBPAqQAuexGAdWyalfiQAMtqtm05YzqAVWq2bTljOoBVarZtOWM6gFVqtm05YzqAVWq2bTljOoBVarZtOWM6gFVqtm05YzqAVWq2bTljOoBVarZtOWM6gFVqtm05YzqAVWq2bTljOoBVarZtOWM6gFVqtm05YzqAVWq2bTljOoBVarZtOWM6gFVqtm05YzqAVWq2bTljOoBVarZtOWM6gFVqtm05YzqAVWq2bTljOoBVarZtOWM6gFVqtm05YzqAVXrqeOjfdvusF8BlA9h5ADsPYOcB7DyAnQew8wB2HsDOA9h5ADsPYOcB7DyAnQew8wB2HsDOA9h5ADsPYOcB7DyAnQew8wB2HsDOA9h5ADsPYOcB7DyAnQew8wB2HsDOA9h5ADsPYOcB7DyAnQew8wB2HsDOA9h5ADsPYOcdz8D/OR76r90+62UITP0IYOcB7DyAnQew8wB2HsDOA9h5ADsPYOcB7DyAnQew8wB2HsDOA9h5ADsPYOcB7DyAnQew8wB2HsDOA9h5ADsPYOcB7DyAnQew8wB2HsDOA9h5ADsPYOcB7DyAnQew8wB23v8Ah3KRANRQ3coAAAAASUVORK5CYII=" style="display: block; margin: auto;" /></p>
<p>Finally, it appears we might have a viable solution for this made-up conservation problem.</p>
</div>
<div id="multiple-zones-with-fragmentation-penalties-and-mandatory-allocations" class="section level3">
<h3>Multiple zones with fragmentation penalties and mandatory allocations</h3>
<p>Finally, we might be interested in conservation planning scenarios where every single planning unit must be allocated to a management zone. This is often the case when developing land-use plans where every single planning unit needs to be allocated to a specific management zone. Though it makes less sense here, let’s see what happens to the solution if we needed to do at least one form of control in every single planning unit.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" title="1"><span class="co"># create matrix that describe boundary penalties between planning units</span></a>
<a class="sourceLine" id="cb58-2" title="2"><span class="co"># allocated to different zones</span></a>
<a class="sourceLine" id="cb58-3" title="3">p7 &lt;-</a>
<a class="sourceLine" id="cb58-4" title="4"><span class="st">  </span><span class="kw">problem</span>(</a>
<a class="sourceLine" id="cb58-5" title="5">    pu4,</a>
<a class="sourceLine" id="cb58-6" title="6">    <span class="kw">zones</span>(</a>
<a class="sourceLine" id="cb58-7" title="7">      sim_features <span class="op">*</span><span class="st"> </span><span class="fl">0.1</span>,</a>
<a class="sourceLine" id="cb58-8" title="8">      sim_features <span class="op">*</span><span class="st"> </span><span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb58-9" title="9">      sim_features <span class="op">*</span><span class="st"> </span><span class="fl">0.8</span>,</a>
<a class="sourceLine" id="cb58-10" title="10">      <span class="dt">zone_names =</span> <span class="kw">names</span>(pu4),</a>
<a class="sourceLine" id="cb58-11" title="11">      <span class="dt">feature_names =</span> <span class="kw">names</span>(sim_features)</a>
<a class="sourceLine" id="cb58-12" title="12">    )</a>
<a class="sourceLine" id="cb58-13" title="13">  ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb58-14" title="14"><span class="st">  </span><span class="kw">add_min_set_objective</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb58-15" title="15"><span class="st">  </span><span class="kw">add_manual_targets</span>(t4) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb58-16" title="16"><span class="st">  </span><span class="kw">add_mandatory_allocation_constraints</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb58-17" title="17"><span class="st">  </span><span class="kw">add_manual_locked_constraints</span>(l5) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb58-18" title="18"><span class="st">  </span><span class="kw">add_boundary_penalties</span>(<span class="dt">penalty =</span> <span class="dv">640</span>, <span class="dt">zones =</span> z6) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb58-19" title="19"><span class="st">  </span><span class="kw">add_binary_decisions</span>()</a>
<a class="sourceLine" id="cb58-20" title="20"></a>
<a class="sourceLine" id="cb58-21" title="21"><span class="co"># print problem</span></a>
<a class="sourceLine" id="cb58-22" title="22"><span class="kw">print</span>(p7)</a></code></pre></div>
<pre><code>## A conservation problem (&lt;ConservationProblem&gt;)
## ├•data
## │├•zones:       &quot;few traps&quot;, &quot;many traps&quot;, and &quot;baiting&quot; (3 total)
## │├•features:    &quot;feature_1&quot;, &quot;feature_2&quot;, &quot;feature_3&quot;, &quot;feature_4&quot;, and &quot;feature_5&quot; (5 total)
## │└•planning units:
## │ ├•data:       &lt;SpatRaster&gt; (100 total)
## │ ├•costs:      continuous values (between 0 and 300)
## │ ├•extent:     0, 0, 1, 1 (xmin, ymin, xmax, ymax)
## │ └•CRS:        Undefined Cartesian SRS (projected)
## ├•formulation
## │├•objective:   minimum set objective
## │├•penalties:
## ││└•1:          boundary penalties (`penalty` = 640, `edge_factor` = 0.5, 0.5, and 0.5, …)
## │├•targets:     absolute targets (between 8 and 8)
## │├•constraints:
## ││├•1:          mandatory allocation constraints
## ││└•2:          manual locked constraints (80 planning units)
## │└•decisions:   binary decision
## └•optimization
##  ├•portfolio:   default portfolio
##  └•solver:      gurobi solver (`gap` = 0.1, `time_limit` = 2147483647, `first_feasible` = FALSE, …)
## # ℹ Use `summary(...)` to see complete formulation.</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" title="1"><span class="co"># solve problem</span></a>
<a class="sourceLine" id="cb60-2" title="2">s7 &lt;-<span class="st"> </span><span class="kw">solve</span>(p7)</a></code></pre></div>
<pre><code>## Set parameter Username
## Set parameter TimeLimit to value 2147483647
## Set parameter MIPGap to value 0.1
## Set parameter Presolve to value 2
## Set parameter Threads to value 1
## Academic license - for non-commercial use only - expires 2025-06-05
## Gurobi Optimizer version 11.0.0 build v11.0.0rc2 (linux64 - &quot;Ubuntu 20.04.6 LTS&quot;)
## 
## CPU model: AMD Ryzen Threadripper 3960X 24-Core Processor, instruction set [SSE2|AVX|AVX2]
## Thread count: 24 physical cores, 48 logical processors, using up to 1 threads
## 
## Optimize a model with 1905 rows, 1200 columns and 5400 nonzeros
## Model fingerprint: 0x3bb74472
## Variable types: 0 continuous, 1200 integer (1200 binary)
## Coefficient statistics:
##   Matrix range     [2e-02, 1e+00]
##   Objective range  [1e+02, 6e+02]
##   Bounds range     [1e+00, 1e+00]
##   RHS range        [1e+00, 8e+00]
## Found heuristic solution: objective 19600.000000
## Presolve removed 1120 rows and 324 columns
## Presolve time: 0.02s
## Presolved: 785 rows, 876 columns, 2448 nonzeros
## Variable types: 0 continuous, 876 integer (876 binary)
## Found heuristic solution: objective 18988.000000
## Root relaxation presolved: 785 rows, 876 columns, 2448 nonzeros
## 
## 
## Root relaxation: objective 1.323093e+04, 265 iterations, 0.00 seconds (0.00 work units)
## 
##     Nodes    |    Current Node    |     Objective Bounds      |     Work
##  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
## 
##      0     0 13230.9255    0   95 18988.0000 13230.9255  30.3%     -    0s
## H    0     0                    13260.000000 13230.9255  0.22%     -    0s
## 
## Explored 1 nodes (410 simplex iterations) in 0.02 seconds (0.03 work units)
## Thread count was 1 (of 48 available processors)
## 
## Solution count 3: 13260 18988 19600 
## 
## Optimal solution found (tolerance 1.00e-01)
## Best objective 1.326000000000e+04, best bound 1.323200000000e+04, gap 0.2112%</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" title="1"><span class="co"># calculate feature representation</span></a>
<a class="sourceLine" id="cb62-2" title="2">r7 &lt;-<span class="st"> </span><span class="kw">eval_feature_representation_summary</span>(p7, s7)</a>
<a class="sourceLine" id="cb62-3" title="3"><span class="kw">print</span>(r7)</a></code></pre></div>
<pre><code>## # A tibble: 20 × 5
##    summary    feature   total_amount absolute_held relative_held
##    &lt;chr&gt;      &lt;chr&gt;            &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;
##  1 overall    feature_1       117.           23.4         0.201 
##  2 overall    feature_2        43.7           8.04        0.184 
##  3 overall    feature_3       101.           19.4         0.192 
##  4 overall    feature_4        59.7          10.9         0.182 
##  5 overall    feature_5        79.4          16.1         0.203 
##  6 few traps  feature_1         8.33          5.92        0.711 
##  7 few traps  feature_2         3.12          2.33        0.745 
##  8 few traps  feature_3         7.20          5.25        0.730 
##  9 few traps  feature_4         4.27          3.18        0.745 
## 10 few traps  feature_5         5.67          4.00        0.706 
## 11 many traps feature_1        41.6           3.02        0.0725
## 12 many traps feature_2        15.6           1.09        0.0700
## 13 many traps feature_3        36.0           2.41        0.0670
## 14 many traps feature_4        21.3           1.66        0.0779
## 15 many traps feature_5        28.4           2.11        0.0743
## 16 baiting    feature_1        66.6          14.4         0.217 
## 17 baiting    feature_2        25.0           4.62        0.185 
## 18 baiting    feature_3        57.6          11.7         0.203 
## 19 baiting    feature_4        34.1           6.05        0.177 
## 20 baiting    feature_5        45.4           9.98        0.220</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" title="1"><span class="co"># plot solution</span></a>
<a class="sourceLine" id="cb64-2" title="2"><span class="kw">plot</span>(<span class="kw">category_layer</span>(s7), <span class="dt">main =</span> <span class="st">&quot;solution&quot;</span>, <span class="dt">axes =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAeAAAAEzCAMAAADeoCAmAAACYVBMVEUAAAABAAIBAQEBAgIBBAQBBQUCAAICCQkDAAQDAwMDCwsEBAQFAAcFBQUFFBMGAAcGBgYHBwcHHRwICAgJAAsJAAwJCQkKCgoLCwsMDAwNDQ0ODg4PDw8PQ0IQDgIQEBARDwIRERESEhIUEgMVFRUXFxcYGBgaGhocGQQcHBweGwQeHh4fHx8gICAhISEhj40iIiIjIAUkJCQlJSUmJiYoKCgpATIqKiorKyssLCwuLi4vLy8xMTEyMjIzMzM0NDQ3Nzc3mpg4ODg5OTk6Ojo7Ozs9PT0+Pj4/Pz9AQEBCQkJEAVRERERFRUVISEhLS0tMTExNTU1OTk5PT09QUFBSUlJTU1NWGmVWVlZaWlpiYmJjY2NkZGRlZWVmZmZsbGxtbW1ubm5wcHBxcXF1dXV2dnZ3d3d4eHh6enp8fHx9fX1+fn6BgYGCgoKDg4OEhISHh4eIiIiLi4uMjIyOZpiOjo6Pj4+QkJCRkZGUlJSYmJiZmZmadqKbm5ucnJydnZ2fn5+hoaGjo6OkpKSlpaWmpqaoqKiqqqqrq6usrKywsLCxsbGysrKzs7O0tLS1tbW3t7e4uLi+vr6/v7/AwMDBwcHDw8PExMTFxcXJycnKuR7MzMzPz8/Q0NDR0dHS0tLT09PV1dXX19fY2Nja2trbyCDc3Nzd3d3e3t7f39/g4ODh4eHi4uLj4+Pk5OTl5eXn5+fo6Ojp6enr6+vs7Ozt7e3u7u7w8PDx8fHy8vLz8/P09PT19fX29vb39/f4+Pj5+fn6+vr7+/v8/Pz95yX96Tr9/f3+8Xz+8or+/v7////jIz0aAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHnklEQVR4nO3d93cUVQCG4StW7B2sWIOIBUUUEAiCDXsDsQv2iogooAg27KBBEcQoYkUFxShYALGh3r/K3c2gs4HLZmbuvZP98r4/5MwOc4bs95xDkj1JMJakM2W/AxQ2gMUDWDyAxQNYPIDFA1g8gMUDWDyAxQNYPIDFA1g8gMVTA77CHFR/YunUqSu3c7rXJA88x5g3AdbJAbxoztxy3p/Sa17gRZe0HDbi7o7q4a8PX3DkqVcvrh7WgAeZ1srhQmOetrefZsywmxL31HWtZlDHDYNOuPbT8p5AnJoWeL6pNXS9tevPrR32mWa3Bb6s+ifjOk+nr2s1x55TfXDappKfR+iaFniwaXlz2e3GPGrtVGMmtj13otnrw22B0x+D09e1GnPWk9MHGvNK2U8kcM0KvMmYkR/bzffe86L9ZR8zfIu1bxlz6w6B665rNX1WWTvLmBllP5PANSuwHVr593X4nW2/W7vCmIeqZ1rMRTsErruu1bRUDpcZM63MJxGhpgVuv6D2AXXIe3ZRDdLaMWbwDoHrrqt8klU5XA5wD+7zxy/ua8xY+4ExD1cfDzTj/wMeXXn8ehfguusA7uG9P2PGV9auHmIG2E17mZH/WPu2MTcmwEPMoRusfWQr8Budp+uuA7iHt9SYK5evXHCcudja24yZvGRBi+nbngBfbsw1LzxwaA14rjEP/tR5On0dwD28LVd1fh28zzvWrhvR+fVt9VOomuRLtcfja8BL/v86OH0dwD29TbPHtex/ysTl1ePND44/4pQr26qHnS9ZzRvRf/TMzo/B9r4T+01OTqeuA5g0Alg8gMUDWDyAxQNYPIDFA1g8gMWLCPxYb+ipeHt2r4jAl/aGro+3Z/cC2G8AiweweACLB7B4AIsHsHgAiweweACLlwL+7Y5bk6ZsqBvi2zXxRgfYcyngjj3OTtqv/qeQb3ki3ugAey4NvPfWk4ekgV+a1Afg5q0x8MLZIwFu3hoDW3sdwM0bwOIBLB7A4qWAf9jp4KTdVtcNAXATl34l65vPkr6uHwLgJo6XKsUDWKbTt9t58fbsXgDnDeCulS3iOYC7VraI5xoDr1ie1B5v5G0COG8NgdftfGDSLqtSM7RfePjQZ+OtDnDeGgJ37Ln15L6pV7LWD5j53fP9l0VbHeC85QR+/czKm2unR1sd4LzlBP5xjbU/D2qLtjrAecsJXKl99M2/R1sd4LzlBd4wZeC8eKMDnLucwFsmTPoh3uYA568x8K5HJe2eAn5t4Jq1a9f+HG11gPPWEHjLrOlJMzf/f/b+2m+85bPonl9D4J4RwHkDuGtli3gO4K6VLeI5gLtWtojnAO5a2SKeA7hrZYt4riHwhuFDkoZ9l5rh5WH9RsV7KRrg3DUE7jjmk6STUy90fHH4q99PG7Ax2uoA560x8PF/JJ2RAn5jkrUb+8T7b4sBzltOYGt/WXbX+HirA+y39M8mOYC/nHDQ4/9EWx1gv3UD2Np1hy2OtjrAfmsIPHNK5c2oOdFWB9hvaeCj3006KQXc1m/huvkHfBRtdYD9lgLeeP6YpLHfp2Z4ZmT/UYvirQ6w3/jhM/EAFg9g8QAWD2DxABYPYPEAFg9g8QAWD2DxABYPYPEAFg9g8QAWD2DxABYPYPEAFg9g8QAWD2DxABYPYPEAFg9g8QAWD2DxABYPYPEAFg9g8QAWD2DxABYPYPEAFg9g8QAWD+Cobf9X/p4e8CYARw1ggD3fBOCoAQyw55sAHDWAAfZ8E4CjBjDAnm8CcNQABtjzTQCOGsAAe74JwFEDGGDPNwE4agAD7PkmAEcNYIA93wTgqAEMsOebABw1gAH2fBOAowawOHD8ABYPYPEAFg9g8QAWD2DxABYPYPEAFg9g8QAWD2DxABYPYPEAFg9g8QAWD2DxABYPYPEAFg9g8QAOk5dvgPYRwGEC2BXAfgM4TAC7AthvAIcJYFcA+w3gMAHsCmC/ARwmgF0B7DeAwwSwK4D9BnCYAHYFsN8ADhPArgD2G8BhAtgVwH4DOEwAuwLYbwCHCWBXAPsN4G0qwcbxV/p4TwDu7trFGd0BHKRsaxdndAdwkLKtXZzRHcBByrZ2cUZ3AAcp29rFGd0BHKRsaxdndAdwkLKtXZzRHcBByrZ2cUZ3AAcp29rFGd0BHKRsaxdndAdwkLKtXZzRHcBByrZ2cUZ3AAcp29rFGd0BHKRsaxdndAdwkLKtXZzRHcBByrZ2cUZ3AAcp29rFGd0BHKRsaxdndAdwkLKtXZzRHcBByrZ2cUZ3AAcp29rFGd0BHKRsaxdndAdwkP7oDf0Zb8/uBbDfABYPYPEAFg9g8QAWD2DxABYPYPEAFg9g8QAWD2DxABYPYPEAFg9g8QAWD2DxABYPYPEAFg9g8QAWD2DxABYPYPEAFg9g8QAWD2DxABYPYPEAFg9g8QAWD2DxABYPYPEAFg9g8QAWD2DxABavNwP/1Rv6O96e3SsiMJURwOIBLB7A4gEsHsDiASwewOIBLB7A4gEsHsDiASwewOIBLB7A4gEsHsDiASwewOIBLB7A4gEsHsDiASwewOIBLB7A4gEsHsDiASwewOIBLB7A4gEsHsDiASwewOL9CzcacnyYKgAfAAAAAElFTkSuQmCC" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="conclusion" class="section level2">
<h2>Conclusion</h2>
<p>Hopefully, this vignette has provided an informative introduction to building and solving problems with multiple zones. Although we have examined only a few different functions here, almost every single function for modifying conservation planning problems is compatible with problems that contain zones. It’s worth noting that working with multiple zones is a lot trickier than working with a single zone, so we would recommend playing around with the code in the <em>Examples</em> sections of the package documentation to help understand how functions work when applied to multiple zones.</p>
</div>
<div id="references" class="section level2 unnumbered">
<h2>References</h2>
<div id="refs" class="references">
<div id="ref-r25">
<p>Cattarino, L., Hermoso, V., Carwardine, J., Adams, V.M., Kennard, M.J. &amp; Linke, S. (2018). Information uncertainty influences conservation outcomes when prioritizing multi-action management efforts. <em>Journal of Applied Ecology</em>, Available at: https://doi.org/10.1111/1365–2664.13147.</p>
</div>
<div id="ref-r27">
<p>Klein, C.J., Tulloch, V.J., Halpern, B.S., Selkoe, K.A., Watts, M.E., Steinback, C., Scholz, A. &amp; Possingham, H.P. (2013). Tradeoffs in marine reserve design: Habitat condition, representation, and socioeconomic costs. <em>Conservation Letters</em>, <em>6</em>, 324–332.</p>
</div>
<div id="ref-r5">
<p>Klein, C., Wilson, K., Watts, M., Stein, J., Berry, S., Carwardine, J., Smith, M.S., Mackey, B. &amp; Possingham, H. (2009). Incorporating ecological and evolutionary processes into continental-scale conservation planning. <em>Ecological Applications</em>, <em>19</em>, 206–217.</p>
</div>
<div id="ref-r4">
<p>Margules, C.R. &amp; Pressey, R.L. (2000). Systematic conservation planning. <em>Nature</em>, <em>405</em>, 243–253.</p>
</div>
<div id="ref-r18">
<p>Stigner, M.G., Beyer, H.L., Klein, C.J. &amp; Fuller, R.A. (2016). Reconciling recreational use and conservation values in a coastal protected area. <em>Journal of Applied Ecology</em>, <em>53</em>, 1206–1214.</p>
</div>
<div id="ref-r2">
<p>Watts, M.E., Ball, I.R., Stewart, R.S., Klein, C.J., Wilson, K., Steinback, C., Lourival, R., Kircher, L. &amp; Possingham, H.P. (2009). Marxan with Zones: Software for optimal conservation based land- and sea-use zoning. <em>Environmental Modelling &amp; Software</em>, <em>24</em>, 1513–1521.</p>
</div>
<div id="ref-r26">
<p>Wilson, K.A., Meijaard, E., Drummond, S., Grantham, H.S., Boitani, L., Catullo, G., Christie, L., Dennis, R., Dutton, I., Falcucci, A. &amp; others. (2010). Conserving biodiversity in production landscapes. <em>Ecological Applications</em>, <em>20</em>, 1721–1732.</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
